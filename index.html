<!DOCTYPE html><html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro de Ventas Celulares</title><!-- Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script><!-- SheetJS --><script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script><!-- Firebase (compat para simplicidad) --><script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script><style>
body{
  background: linear-gradient(135deg,#0f172a,#020617);
}
</style></head><body class="text-white min-h-screen p-6"><div class="max-w-7xl mx-auto"><!-- HEADER --><div class="bg-slate-900/80 backdrop-blur rounded-2xl p-6 shadow-2xl border border-slate-700 flex justify-between items-center">
<div>
<h1 class="text-3xl font-bold mb-2">ðŸ“± Registro de Ventas</h1>
<p class="text-slate-400">Sistema profesional de control</p>
</div><button onclick="cerrarSesion()" class="bg-red-500 hover:bg-red-600 px-5 py-2 rounded-xl font-semibold shadow-lg">
Cerrar sesiÃ³n
</button>
</div><!-- FORM --><div class="mt-6 bg-slate-900/80 backdrop-blur rounded-2xl p-6 shadow-2xl border border-slate-700">
<h2 class="text-xl font-semibold mb-4">Nueva venta</h2><div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<input id="tel" placeholder="TelÃ©fono" class="input">
<input id="imei" placeholder="IMEI" class="input">
<input id="iccid" placeholder="ICCID" class="input"><input id="tipo" placeholder="Tipo" class="input">
<input id="tiendaNum" placeholder="No. tienda" class="input">
<input id="cadena" placeholder="Cadena" class="input"><input id="tiendaNom" placeholder="Nombre tienda" class="input">
<input id="prom" placeholder="Promotor" class="input">
<input id="fec" type="date" class="input"><input id="marca" placeholder="Marca" class="input">
<input id="mod" placeholder="Modelo" class="input">
</div><button onclick="guardar()" class="mt-6 bg-emerald-500 hover:bg-emerald-600 px-6 py-3 rounded-xl font-semibold shadow-lg">
Guardar venta
</button><button onclick="bajarExcel()" class="mt-6 ml-3 bg-blue-500 hover:bg-blue-600 px-6 py-3 rounded-xl font-semibold shadow-lg">
Exportar Excel original
</button></div><!-- TABLA --><div class="mt-6 bg-slate-900/80 backdrop-blur rounded-2xl p-6 shadow-2xl border border-slate-700">
<h2 class="text-xl font-semibold mb-4">Historial</h2>
<div class="overflow-auto">
<table class="w-full text-sm">
<thead class="bg-slate-800">
<tr>
<th class="th">Tel</th>
<th class="th">IMEI</th>
<th class="th">ICCID</th>
<th class="th">Tipo</th>
<th class="th">Tienda</th>
<th class="th">Cadena</th>
<th class="th">Nombre</th>
<th class="th">Prom</th>
<th class="th">Fecha</th>
<th class="th">Marca</th>
<th class="th">Modelo</th>
</tr>
</thead>
<tbody id="tabla"></tbody>
</table>
</div>
</div></div><style>
.input{
  background:#020617;
  border:1px solid #334155;
  padding:10px;
  border-radius:10px;
}
.th{
  padding:10px;
  text-align:left;
}
.td{
  padding:8px;
  border-top:1px solid #1e293b;
}
</style><script>

// ==============================
// CONFIG FIREBASE (PEGA LA TUYA)
// ==============================
const firebaseConfig = {
  apiKey: "",
  authDomain: "",
  databaseURL: "",
  projectId: "",
  storageBucket: "",
  messagingSenderId: "",
  appId: ""
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// usuario simple
const uA = "usuario_demo";


// ==============================
// CERRAR SESION
// ==============================
function cerrarSesion(){

if(confirm("Â¿Seguro que quieres cerrar sesiÃ³n?")){

localStorage.clear();
sessionStorage.clear();

alert("SesiÃ³n cerrada correctamente");
location.reload();

}

}


// ==============================
// GUARDAR
// ==============================
function guardar(){

const data = {
 tel: tel.value,
 imei: imei.value,
 iccid: iccid.value,
 tipo: tipo.value,
 tiendaNum: tiendaNum.value,
 cadena: cadena.value,
 tiendaNom: tiendaNom.value,
 prom: prom.value,
 fec: fec.value,
 marca: marca.value,
 mod: mod.value
};

const id = Date.now();
db.ref('ventas/'+btoa(uA)+'/'+id).set(data);

alert("Guardado correctamente");

}


// ==============================
// CARGAR TABLA
// ==============================
db.ref('ventas/'+btoa(uA)).on('value',snap=>{

const datos = snap.val() || {};
tabla.innerHTML="";

Object.values(datos).forEach(v=>{

const tr=document.createElement('tr');
tr.innerHTML=`
<td class="td">${v.tel||""}</td>
<td class="td">${v.imei||""}</td>
<td class="td">${v.iccid||""}</td>
<td class="td">${v.tipo||""}</td>
<td class="td">${v.tiendaNum||""}</td>
<td class="td">${v.cadena||""}</td>
<td class="td">${v.tiendaNom||""}</td>
<td class="td">${v.prom||""}</td>
<td class="td">${v.fec||""}</td>
<td class="td">${v.marca||""}</td>
<td class="td">${v.mod||""}</td>
`;

tabla.appendChild(tr);

});

});


// ==============================
// EXPORTAR EXCEL PLANTILLA REAL
// ==============================
async function bajarExcel(){

const res = await fetch("omarcitoo2026.xlsx");
const buffer = await res.arrayBuffer();

const wb = XLSX.read(buffer,{type:"array"});
const hoja = wb.SheetNames[0];
const ws = wb.Sheets[hoja];

const snap = await db.ref('ventas/'+btoa(uA)).once('value');
const datos = Object.values(snap.val()||{});

let fila=2;

datos.forEach(v=>{
ws["A"+fila]={t:"s",v:v.tel};
ws["B"+fila]={t:"s",v:v.imei};
ws["C"+fila]={t:"s",v:v.iccid};
ws["D"+fila]={t:"s",v:v.tipo};
ws["E"+fila]={t:"s",v:v.tiendaNum};
ws["F"+fila]={t:"s",v:v.cadena};
ws["G"+fila]={t:"s",v:v.tiendaNom};
ws["H"+fila]={t:"s",v:v.prom};
ws["I"+fila]={t:"s",v:v.fec};
ws["J"+fila]={t:"s",v:v.marca};
ws["K"+fila]={t:"s",v:v.mod};
fila++;
});

XLSX.writeFile(wb,"Reporte_Ventas.xlsx");

}

</script></body>
</html>