<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Ventas Telcel Pro</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body{
    font-family: Arial;
    background:#0f172a;
    color:white;
    margin:0;
    padding:20px;
}
h1{ text-align:center; }

.container{
    max-width:900px;
    margin:auto;
}

input, button{
    padding:10px;
    margin:5px 0;
    width:100%;
    border-radius:8px;
    border:none;
}

button{
    background:#22c55e;
    color:white;
    font-weight:bold;
    cursor:pointer;
}

button:hover{
    opacity:0.8;
}

.card{
    background:#1e293b;
    padding:15px;
    border-radius:12px;
    margin-top:20px;
}

.chat-box{
    height:200px;
    overflow-y:auto;
    background:#0f172a;
    padding:10px;
    border-radius:8px;
}
</style>
</head>
<body>

<div class="container">

<h1>üìä Sistema Ventas Telcel Pro</h1>

<div class="card">
<h3>Registrar Venta</h3>

<input type="text" id="nombrePromotor" placeholder="Nombre del promotor">
<input type="text" id="cliente" placeholder="Nombre del cliente">
<input type="number" id="monto" placeholder="Monto">

<button onclick="guardarVenta()">Guardar Venta</button>
</div>

<div class="card">
<h3>Ventas Registradas</h3>
<div id="listaVentas"></div>
</div>

<div class="card">
<h3>üí¨ Chat Global Promotores</h3>
<div class="chat-box" id="chatBox"></div>
<input type="text" id="mensajeChat" placeholder="Escribe un mensaje">
<button onclick="enviarMensaje()">Enviar</button>
</div>

</div>

<script>

// üî• CONFIGURA AQU√ç TU FIREBASE
var firebaseConfig = {
    apiKey: "TU_API_KEY",
    authDomain: "TU_DOMINIO.firebaseapp.com",
    databaseURL: "https://TU_DATABASE.firebaseio.com",
    projectId: "TU_ID",
    storageBucket: "TU_BUCKET",
    messagingSenderId: "TU_SENDER",
    appId: "TU_APP_ID"
};

firebase.initializeApp(firebaseConfig);
var database = firebase.database();

// ===============================
// GUARDAR VENTA (Firebase + Local)
// ===============================

function guardarVenta(){

    var promotor = document.getElementById("nombrePromotor").value;
    var cliente = document.getElementById("cliente").value;
    var monto = document.getElementById("monto").value;

    if(!promotor || !cliente || !monto){
        alert("Completa todos los campos");
        return;
    }

    var venta = {
        promotor: promotor,
        cliente: cliente,
        monto: monto,
        fecha: new Date().toLocaleString()
    };

    // üî• Guardar en Firebase
    database.ref("ventas").push(venta);

    // üî• Guardar en LocalStorage (respaldo)
    var ventasLocales = JSON.parse(localStorage.getItem("ventas")) || [];
    ventasLocales.push(venta);
    localStorage.setItem("ventas", JSON.stringify(ventasLocales));

    mostrarVentas();

    document.getElementById("cliente").value="";
    document.getElementById("monto").value="";
}

// ===============================
// MOSTRAR VENTAS LOCALES
// ===============================

function mostrarVentas(){
    var lista = document.getElementById("listaVentas");
    lista.innerHTML="";

    var ventasLocales = JSON.parse(localStorage.getItem("ventas")) || [];

    ventasLocales.forEach(function(v){
        lista.innerHTML += `
            <p>üë§ ${v.promotor} | üßæ ${v.cliente} | üí∞ $${v.monto} | üìÖ ${v.fecha}</p>
        `;
    });
}

mostrarVentas();

// ===============================
// CHAT GLOBAL
// ===============================

function enviarMensaje(){

    var promotor = document.getElementById("nombrePromotor").value;
    var mensaje = document.getElementById("mensajeChat").value;

    if(!promotor){
        alert("Escribe tu nombre primero");
        return;
    }

    if(!mensaje) return;

    database.ref("chatGlobal").push({
        nombre: promotor,
        mensaje: mensaje,
        hora: new Date().toLocaleTimeString()
    });

    document.getElementById("mensajeChat").value="";
}

// Escuchar mensajes en tiempo real
database.ref("chatGlobal").limitToLast(50).on("child_added", function(snapshot){

    var data = snapshot.val();
    var chatBox = document.getElementById("chatBox");

    chatBox.innerHTML += `
        <p><strong>${data.nombre}:</strong> ${data.mensaje} <small>(${data.hora})</small></p>
    `;

    chatBox.scrollTop = chatBox.scrollHeight;
});

</script>

</body>
</html>