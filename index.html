<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Ventas Telcel Pro</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body{
    font-family: Arial;
    background:#f4f6f9;
    padding:20px;
}

input, button{
    padding:8px;
    margin:5px 0;
    width:100%;
}

button{
    background:#0057ff;
    color:white;
    border:none;
    cursor:pointer;
}

button:hover{
    opacity:0.8;
}

table{
    margin-top:20px;
    border-collapse: collapse;
    width:100%;
    background:white;
}

th, td{
    border:1px solid #ddd;
    padding:8px;
    text-align:center;
}

th{
    background:#0057ff;
    color:white;
}
</style>
</head>

<body>

<h2>Registrar Venta</h2>

<input type="date" id="fecha">
<input type="text" id="promotor" placeholder="Nombre del promotor">
<input type="text" id="ak" placeholder="AK">
<input type="text" id="folio" placeholder="Folio">
<input type="text" id="producto" placeholder="Producto">
<input type="number" id="monto" placeholder="Monto">

<button onclick="guardarVenta()">Guardar Venta</button>

<h2>Ventas Registradas</h2>

<table id="tablaVentas">
<thead>
<tr>
<th>Fecha</th>
<th>Promotor</th>
<th>AK</th>
<th>Folio</th>
<th>Producto</th>
<th>Monto</th>
<th>Acci√≥n</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

<script>

// üî• CONFIGURA TU FIREBASE AQU√ç
var firebaseConfig = {
    apiKey: "TU_API_KEY",
    authDomain: "TU_DOMINIO",
    databaseURL: "TU_DATABASE_URL",
    projectId: "TU_PROJECT_ID",
    storageBucket: "TU_BUCKET",
    messagingSenderId: "TU_SENDER_ID",
    appId: "TU_APP_ID"
};

firebase.initializeApp(firebaseConfig);
var database = firebase.database();

// ===============================
// GUARDADO LOCAL
// ===============================

function guardarVentaLocal(venta){
    let ventas = JSON.parse(localStorage.getItem("ventasLocales")) || [];
    ventas.push(venta);
    localStorage.setItem("ventasLocales", JSON.stringify(ventas));
}

function obtenerVentasLocales(){
    return JSON.parse(localStorage.getItem("ventasLocales")) || [];
}

// ===============================
// MOSTRAR EN TABLA
// ===============================

function mostrarVentaEnTabla(venta, index){

    let tabla = document.querySelector("#tablaVentas tbody");

    let fila = `
        <tr>
            <td>${venta.fecha}</td>
            <td>${venta.promotor}</td>
            <td>${venta.ak}</td>
            <td>${venta.folio}</td>
            <td>${venta.producto}</td>
            <td>${venta.monto}</td>
            <td>
                <button onclick="eliminarVenta(${index})">Eliminar</button>
            </td>
        </tr>
    `;

    tabla.innerHTML += fila;
}

// ===============================
// ELIMINAR VENTA LOCAL
// ===============================

function eliminarVenta(index){

    let ventas = obtenerVentasLocales();

    ventas.splice(index, 1);

    localStorage.setItem("ventasLocales", JSON.stringify(ventas));

    recargarTabla();
}

// ===============================
// RECARGAR TABLA
// ===============================

function recargarTabla(){

    document.querySelector("#tablaVentas tbody").innerHTML = "";

    let ventas = obtenerVentasLocales();

    ventas.forEach((venta, index)=>{
        mostrarVentaEnTabla(venta, index);
    });
}

// ===============================
// GUARDAR VENTA
// ===============================

function guardarVenta(){

    let datosVenta = {
        fecha: document.getElementById("fecha").value,
        promotor: document.getElementById("promotor").value,
        ak: document.getElementById("ak").value,
        folio: document.getElementById("folio").value,
        producto: document.getElementById("producto").value,
        monto: document.getElementById("monto").value
    };

    if(!datosVenta.promotor || !datosVenta.ak){
        alert("Completa los datos obligatorios");
        return;
    }

    // üî• Guarda en Firebase
    database.ref("ventas").push(datosVenta);

    // üî• Guarda local
    guardarVentaLocal(datosVenta);

    // üî• Recargar tabla
    recargarTabla();

    // Limpiar campos
    document.querySelectorAll("input").forEach(input => input.value = "");

    alert("Venta guardada correctamente");
}

// ===============================
// CARGAR VENTAS AL ABRIR
// ===============================

window.onload = function(){
    recargarTabla();
};

</script>

</body>
</html>