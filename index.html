<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Ventas Telcel Pro</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{
margin:0;
font-family:'Segoe UI',system-ui;
background:linear-gradient(135deg,#001d3d,#003566,#000814);
min-height:100vh;
color:white;
}

.app{max-width:480px;margin:auto;padding:20px;}

.card{
background:rgba(255,255,255,.08);
backdrop-filter:blur(12px);
border-radius:18px;
padding:18px;
margin-bottom:16px;
box-shadow:0 10px 25px rgba(0,0,0,.3);
}

.header{
text-align:center;
font-size:22px;
font-weight:bold;
color:#ffc300;
margin-bottom:20px;
}

label{
font-size:11px;
font-weight:600;
color:#ffc300;
}

input,select{
width:100%;
padding:12px;
margin-top:4px;
margin-bottom:12px;
border-radius:10px;
border:none;
background:rgba(255,255,255,.12);
color:white;
}

button{
width:100%;
padding:14px;
border:none;
border-radius:12px;
font-weight:bold;
cursor:pointer;
margin-bottom:10px;
}

.btn-main{background:#ffc300;color:#003566;}
.btn-excel{background:#1f7a3f;color:white;}
.btn-register{background:#003566;color:#ffc300;}

.login{
max-width:350px;
margin:120px auto;
background:white;
color:black;
padding:30px;
border-radius:18px;
text-align:center;
}

.hidden{display:none}
</style>
</head>

<body onload="inicio()">

<!-- LOGIN -->
<div id="loginBox" class="login">
<h2>Acceso Sistema</h2>
<input id="u" placeholder="Correo">
<input id="p" type="password" placeholder="Contrase침a">
<button onclick="entrar()">Entrar</button>
<button class="btn-register" onclick="registrarUsuario()">Registrar nuevo usuario</button>
</div>

<!-- APP -->
<div id="appBox" class="app hidden">

<div class="header">
<i class="fa-solid fa-signal"></i> Sistema Ventas Telcel
</div>

<form id="fReg">

<div class="card">
<label>NUM CELULAR</label>
<input id="iTel" required>
<label>ICCID</label>
<input id="iIcc" required>
<label>TIPO</label>
<select id="iTipo" required>
<option value="">Seleccionar</option>
<option>KIT</option>
<option>CHIP</option>
<option>PORTA</option>
<option>RENUEVATE</option>
</select>
</div>

<div class="card">
<label>IMEI</label>
<input id="iIme">
<label>MARCA</label>
<input id="iMarca">
<label>MODELO</label>
<input id="iMod">
</div>

<div class="card">
<label>TIENDA</label>
<input id="iTiendaNum" required>
<label>CADENA</label>
<input id="iCadena" required>
<label>NOMBRE TIENDA</label>
<input id="iTiendaNombre" required>
<label>PROMOTOR</label>
<input id="iProm" required>
<label>FECHA</label>
<input type="date" id="iFec" required>
</div>

<button class="btn-main">Guardar Venta</button>
</form>

<button class="btn-excel" onclick="descargarPlantilla()">
<i class="fa-solid fa-file-excel"></i> Descargar formato Excel
</button>

<button onclick="salir()">Cerrar sesi칩n</button>

</div>

<script>

const firebaseConfig={
apiKey:"AIzaSy",
databaseURL:"https://ventastelcel4029-default-rtdb.firebaseio.com"
}

let uA="",db

function inicio(){
firebase.initializeApp(firebaseConfig)
db=firebase.database()
iFec.value=new Date().toISOString().split('T')[0]
}

function entrar(){
uA=u.value
if(!uA || !p.value){
alert("Ingresa correo y contrase침a")
return
}
loginBox.classList.add("hidden")
appBox.classList.remove("hidden")
}

function registrarUsuario(){
if(!u.value || !p.value){
alert("Escribe correo y contrase침a")
return
}

db.ref("usuarios/"+btoa(u.value)).set({
correo:u.value,
password:p.value
}).then(()=>{
alert("Usuario registrado correctamente")
})
}

function salir(){
location.reload()
}

fReg.onsubmit=e=>{
e.preventDefault()

const v={
tel:iTel.value,
iccid:iIcc.value,
tipo:iTipo.value,
tiendaNum:iTiendaNum.value,
cadena:iCadena.value,
tiendaNom:iTiendaNombre.value,
prom:iProm.value,
fec:iFec.value,
imei:iIme.value,
marca:iMarca.value,
mod:iMod.value
}

// 游댠 Guardar en Firebase
db.ref('ventas/'+btoa(uA)).push(v)

// 游댠 Guardar COMPLETO en almacenamiento local
let ventasLocal = JSON.parse(localStorage.getItem("ventasLocal")) || []
ventasLocal.push(v)
localStorage.setItem("ventasLocal", JSON.stringify(ventasLocal))

fReg.reset()
iFec.value=new Date().toISOString().split('T')[0]
alert("Venta guardada correctamente")
}

function descargarPlantilla(){
const link=document.createElement("a")
link.href="omarcitoo2026.xlsx"
link.download="Formato_Registro_Telcel.xlsx"
link.click()
}

</script>

</body>
</html>